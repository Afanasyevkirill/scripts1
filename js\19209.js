"use strict";(self.webpackChunkof_vue=self.webpackChunkof_vue||[]).push([[19209,21625],{18500:function(e,t,n){n.d(t,{A:function(){return l}});var o=function e(){var t=this,n=t._self._c;return n(t.componentProps.name,t._b({tag:"component",scopedSlots:t._u([t.iconName?{key:"button-content",fn:function(){return[n("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite:[`icon-${iconName}`]",arg:`icon-${t.iconName}`}]})]},proxy:!0}:null],null,!0)},"component",t.componentProps.attributes,!1),[t._t("default")],2)},a=[],i,s={name:"VolumeButton",props:{iconName:{type:String,default:""},classes:{type:String,default:""},toggleClasses:{type:String,default:""},menuClasses:{type:String,default:""}},computed:{componentProps(){return this.iconName?{name:"b-dropdown",attributes:{class:`b-volume-btn m-btn-round ${this.classes}`,left:!0,toggleClass:`b-volume-btn__el g-btn m-rounded m-icon m-icon-only m-colored ${this.toggleClasses}`,menuClass:`m-list-switcher m-appearance-modal ${this.menuClasses}`}}:{name:"div",attributes:{class:`b-volume-btn ${this.classes}`}}}}},u,r,l=(0,n(281656).A)(s,o,a,!1,null,"012b4cb4",null).exports},289584:function(e,t,n){n.d(t,{A:function(){return I}});var o=function e(){var t=this,n=t._self._c,o=t._self._setupProxy;return n("div",{class:["b-audioplayer",{"m-audio-rewind":t.isTimelineFocused}],on:{pointerdown:function(e){e.stopPropagation()},pointerup:function(e){e.stopPropagation()},pointermove:function(e){e.stopPropagation()},pointercancel:function(e){e.stopPropagation()}}},[n("button",{staticClass:"b-audioplayer__btn-play m-with-round-hover m-btn-player",attrs:{type:"button"},on:{click:t.toggleAudioPlayState}},[n("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite:[icons.playButton]",arg:t.icons.playButton}]})]),n("volume-button",{attrs:{classes:"m-btn-player m-with-round-hover "+(t.showVolumeRange?"m-visible-volume-control":"")}},[n("div",t._g({},t.volumeButtonListeners),[n("input",{staticClass:"b-volume-btn__range-control m-horizontal",class:{"g-invisible":!t.showVolumeRange},style:t.volumeRangeStyle,attrs:{type:"range",min:"0",max:"1",step:"0.05"},domProps:{value:t.audioData.lastSavedVolume},on:{input:function(e){return t.setAudioData({lastSavedVolume:e.target.value})}}}),n("button",{staticClass:"b-audioplayer__btn-volume m-btn-player",attrs:{type:"button"},on:{click:t.toggleVolume}},[n("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite:[icons.volumeButton]",arg:t.icons.volumeButton}]})])])]),n("div",{ref:"timelineDOMRef",staticClass:"b-audioplayer__timeline",on:{mousedown:function(e){return e.stopPropagation(),t.handleTimelineFocus.apply(null,arguments)},touchstart:function(e){return e.stopPropagation(),t.handleTimelineFocus.apply(null,arguments)}}},[n("div",{staticClass:"b-audioplayer__playhead",style:{left:`${t.timelinePercentage}%`}}),n("div",{staticClass:"b-audioplayer__progress",style:{width:`${t.timelinePercentage}%`}})]),n("div",{staticClass:"b-audioplayer__timing"},[n("span",[t._v(t._s(t.formattedCurrentTime))])]),n("div",{staticClass:"g-hidden b-audioplayer__error-msg"})],1)},a=[],i=n(97200),s=n.n(i),u=n(885471),r=n(826489),l=n(18500),d=n(375393),c=n(16280),m=n(218111),p=n(13579);const v=(e,t,n)=>{if("object"!=typeof e)throw new Error(`Invalid data type: ${typeof e}. Expected: object`);const o=undefined;if(n.some((e=>!t.includes(e))))throw new Error(`Invalid data structure. Allowed keys: ${t}. Passed: ${n}`)},y=()=>{const e=(0,u.ref)(),t=(0,u.reactive)({currentTime:0,duration:0,lastSavedVolume:(0,d.A)(),state:"paused"}),n=(0,u.reactive)({playButton:"icon-loading",volumeButton:""}),o=e=>{try{v(e,Object.keys(t),Object.keys(e)),Object.assign(t,e)}catch(n){console.error("[CustomAudioPlayer][setAudioData] error:",n)}},a=e=>{try{v(e,Object.keys(n),Object.keys(e)),Object.assign(n,e)}catch(t){console.error("[CustomAudioPlayer][setIcons] error:",t)}};return{audioDOMRef:e,audioData:(0,u.readonly)(t),icons:(0,u.readonly)(n),setIcons:a,setAudioData:o}},g=60,f=e=>e?e>.5?"high":e<=.5?"low":void 0:"off",h=e=>e>=10?`${e}`:`0${e}`,_=({duration:e,currentTime:t})=>{const n="number"==typeof e&&e!==1/0?e:0,o=Math.abs(n-t),a=Math.floor(o/g),i=Math.floor(o%g);return`-${h(a)}:${h(i)}`},b=({audioDOMRef:e,audioData:t,setIcons:n,setAudioData:o})=>{const a=(0,u.ref)(!1),i=(0,u.ref)(t.lastSavedVolume),s=undefined,l=undefined,d=undefined;return{showRange:a,rangeStyle:(0,u.computed)((()=>({backgroundImage:`linear-gradient(to right, #00AFF0 ${100*t.lastSavedVolume}%, rgba(138, 150, 163, .25) ${100*t.lastSavedVolume}%)`}))),toggle:()=>{if(r.isIOS)return void o({lastSavedVolume:e.value.muted?1:0});const t=e.value.volume;t&&(i.value=t);const n=t?0:i.value||1;o({lastSavedVolume:n})},updateIcon:()=>{const t=r.isIOS?e.value.muted?"off":"high":f(e.value.volume);n({volumeButton:`icon-volume-${t}`})}}},w=({audioDOMRef:e,audioData:t,setIcons:n,setAudioData:o},a,i)=>{const s=(0,u.ref)(),r=(0,u.ref)(0),l=(0,u.ref)(!1),d=e=>{var t,n;const o=undefined;return(e-((null==s||null===(t=s.value)||void 0===t?void 0:t.getBoundingClientRect().left)||0))/((null==s||null===(n=s.value)||void 0===n?void 0:n.offsetWidth)||1)},c=o=>{l.value=!0;const a=d(o.clientX);r.value=100*a,"playing"===t.state&&(e.value.pause(),n({playButton:"icon-play"})),window.addEventListener("mouseup",p),window.addEventListener("mousemove",m)},m=n=>{n.stopPropagation();const a=n.clientX||n.touches[0].clientX,i=d(a)*e.value.duration;i>=t.duration||i<=0||(e.value.currentTime=i,o({currentTime:i}))},p=o=>{o.stopPropagation();const s=o.clientX||o.changedTouches[0].clientX;e.value.currentTime=d(s)*e.value.duration,e.value.addEventListener("timeupdate",a),"playing"===t.state&&(i(),n({playButton:"icon-pause"})),window.removeEventListener("mouseup",p),window.removeEventListener("mousemove",m),l.value=!1};return{percentage:r,isFocused:l,domRef:s,onFocus:c}},S=({audioDOMRef:e,setIcons:t,setAudioData:n})=>{const o=undefined,a=undefined,i=()=>{n({duration:e.value.duration}),t({playButton:"icon-play"}),e.value.removeEventListener("loadedmetadata",i)},s=undefined;return{onTimeUpdate:()=>{n({currentTime:e.value.currentTime})},onLoadedMetadata:i,onEnd:()=>{e.value.currentTime=0,t({playButton:"icon-play"}),n({state:"paused"})},onError:()=>{t({playButton:"icon-alert"})}}};var A,C=(0,u.defineComponent)({components:{VolumeButton:l.A},props:{src:{type:String,default:null},hideError:{type:Boolean,default:!1}},setup(e,{emit:t,expose:n}){const{proxy:o}=(0,u.getCurrentInstance)(),a=s()("audio-player-"),i=y(),{audioDOMRef:l,audioData:c,icons:m,setIcons:p,setAudioData:v}=i,{onTimeUpdate:g,onEnd:f,onLoadedMetadata:h,onError:A}=S(i),{percentage:C,isFocused:E,domRef:T,onFocus:I}=w(i,g,L),{showRange:V,rangeStyle:D,toggle:O,updateIcon:$}=b(i),P=(0,u.computed)((()=>{const{duration:e,currentTime:t}=c;return _({duration:e,currentTime:t})})),B=(0,u.computed)((()=>Boolean(c.duration)));function L(){o.$root.$emit("pausePlayerAudio",a),"play"in l.value&&l.value.play(),t("play")}const M=()=>{const n=new Audio(e.src);n.load(),n.controlslist="nodownload",n.preload="metadata",n.volume=c.lastSavedVolume,l.value=n,l.value.addEventListener("loadedmetadata",h),l.value.addEventListener("timeupdate",g),l.value.addEventListener("ended",f),l.value.addEventListener("error",(n=>{t("error",n),e.hideError||A(n)})),$()},R=()=>{if(!l.value.error){if(l.value.paused)return p({playButton:"icon-pause"}),v({lastSavedVolume:(0,d.A)(),state:"playing"}),void L();l.value.pause(),p({playButton:"icon-play"}),v({state:"paused"})}},j=e=>{B.value&&(l.value.removeEventListener("timeupdate",g),I(e))},N=()=>{B.value&&(l.value.pause(),p({playButton:"icon-play"}))},k=e=>{e?e!==a&&N():N()},x=(0,u.computed)((()=>r.isIOS?{}:{mouseenter:()=>V.value=!0,mouseleave:()=>V.value=!1}));return(0,u.onMounted)((()=>{M(),o.$root.$on("pausePlayerAudio",k)})),(0,u.onBeforeUnmount)((()=>{N(),o.$root.$off("pausePlayerAudio",k)})),(0,u.watch)((()=>c.currentTime),(()=>{const{currentTime:e,duration:t}=c;C.value=e/t*100})),(0,u.watch)((()=>c.lastSavedVolume),(e=>{l.value.volume=e,l.value.muted=!e,$(),(0,d.C)(e)})),(0,u.watch)((()=>e.src),(e=>{l.value.src=e,l.value.load()})),n({pauseAudio:N}),{isIOS:r.isIOS,icons:m,audioData:c,timelineDOMRef:T,showVolumeRange:V,volumeRangeStyle:D,isTimelineFocused:E,timelinePercentage:C,formattedCurrentTime:P,volumeButtonListeners:x,setAudioData:v,toggleVolume:O,toggleAudioPlayState:R,handleTimelineFocus:j}}}),E,T,I=(0,n(281656).A)(C,o,a,!1,null,null,null).exports},969200:function(e,t,n){n.d(t,{A:function(){return l}});var o=function e(){var t=this,n;return(0,t._self._c)("div",{staticClass:"post_media"},[t._t("default")],2)},a=[],i,s={name:"PostMediaWrapper"},u,r,l=(0,n(281656).A)(s,o,a,!1,null,"00bae661",null).exports},996705:function(e,t,n){n.d(t,{A:function(){return v}});var o=function e(){var t=this,n=t._self._c;return n("div",{staticClass:"switcher-media-content js-switcher-media-content",class:{"m-vjs-settings-menu":t.isShowingVideoQualityMenu}},t._l(t.visibleMediaWithoutAudioByType,(function(e,o){return n("div",{key:o,staticClass:"switcher-media-content__btn",class:{"active-btn":t.currentIndex===o}},[n("div",{staticClass:"switcher-media-content__icon"},[n("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],class:{"icon-media":"photo"===e.type,"icon-video":!t.isStream&&"video"===e.type,"icon-live":t.isStream&&"video"===e.type}})]),e.media.length>1?[t.currentIndex===o?n("span",{staticClass:"switcher-media-content__val"},[n("span",[t._v(t._s(t.currentMediaTypeItemNum))]),t._v("/ ")]):t._e(),n("span",{staticClass:"switcher-media-content__val-total"},[t._v(t._s(e.media.length))])]:t.getDuration(o)?n("span",{staticClass:"switcher-media-content__val"},[t._v(" "+t._s(t.getDuration(o))+" ")]):t._e()],2)})),0)},a=[],i=n(178688),s=n(547822);const{$on:u,$off:r,EVENTS:l}=(0,s.A)();var d,c={name:"PostContentSwitcher",mixins:[i.A],props:{post:{type:Object,required:!0},message:{type:Object,default:()=>({})},currentMediaTypeItemNum:{type:Number,required:!0},currentIndex:{type:Number,required:!0},isLinked:{type:Boolean,default:!1}},data(){return{isShowingVideoQualityMenu:!1}},computed:{entityId(){var e,t;return(null===(e=this.post)||void 0===e?void 0:e.id)||(null===(t=this.message)||void 0===t?void 0:t.id)}},mounted(){u(l.VIDEO_JS.QUALITY_SELECTOR.SHOWN,this.shownVideojsQualitySelectorHandler),u(l.VIDEO_JS.QUALITY_SELECTOR.HIDDEN,this.hiddenVideojsQualitySelectorHandler)},beforeDestroy(){r(l.VIDEO_JS.QUALITY_SELECTOR.SHOWN,this.shownVideojsQualitySelectorHandler),r(l.VIDEO_JS.QUALITY_SELECTOR.HIDDEN,this.hiddenVideojsQualitySelectorHandler)},methods:{changeType(e){this.isLinked||this.$emit("changeType",e)},shownVideojsQualitySelectorHandler({id:e}){e===this.entityId&&(this.isShowingVideoQualityMenu=!0)},hiddenVideojsQualitySelectorHandler({id:e}){e===this.entityId&&(this.isShowingVideoQualityMenu=!1)}}},m,p,v=(0,n(281656).A)(c,o,a,!1,null,"dfc943ce",null).exports}}]);