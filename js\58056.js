"use strict";(self.webpackChunkof_vue=self.webpackChunkof_vue||[]).push([[58056],{59960:function(e,t,s){var i=s(828431),r=s(110908),o=s(957903),a=s(139162),n=s(826489),d=s.n(n);t.A={computed:{...(0,r.npG)(["authUserId"]),copyProfileLinkMixin_title(){return this.$t(`message.${this.copyProfileLinkMixin_canShareProfile?"share":"copy"}_link_to_profile_btn`)},copyProfileLinkMixin_canShareProfile(){return navigator.share&&n.isMobile},copyProfileLinkMixin_copyLink(){const{username:e,id:t,subscribedBy:s,subscribedIsExpiredNow:i}=this.user||{};if(!e)return"";const r=this.$router.resolve({name:"Profile",params:{userId:e}});let o=`${this.$window.location.origin}${r.href}`;return this.authUserId&&t!==this.authUserId&&(s||i)&&(o+=`?rec=${this.authUserId}`),o}},methods:{copyProfileLinkMixin_doCopy(){const{username:e,name:t}=this.user||{};e&&(this.copyProfileLinkMixin_canShareProfile?navigator.share({title:(0,o.iT)(t),url:this.copyProfileLinkMixin_copyLink}).catch((()=>{})):this.$copyText(this.copyProfileLinkMixin_copyLink,document.querySelector(".modal-body")||document.body).then((()=>{this.$bvToast.toast(this.$t("message.copy_link_to_profile_btn_copied"),a.fy)})))}}}},277678:function(e,t,s){var i=s(725440),r=s.n(i),o=s(962953),a=s.n(o),n=s(976760);t.A={computed:{blockUserRouteFlags(){return{isAllowedPage:["Profile",...n.SX,...n.ad,...n.I0].includes(this.$route.name),isSubscribesPage:["Subscribes","SubscribesByType"].includes(this.$route.name),isSubscribersPage:["Subscribers","SubscribersByType"].includes(this.$route.name),isProfilePage:"Profile"===this.$route.name,isChatsPage:["Chat","Chats"].includes(this.$route.name)}}},methods:{hideModal(){this.$root.$emit("bv::hide::modal","ModalSubscribersItem")},redirectToChatsIfChat(){"Chat"===this.$route.name&&this.$router.replace({name:"Chats"})}}}},399941:function(e,t,s){s.d(t,{A:function(){return g}});var i=function e(){var t=this,s=t._self._c;return s("div",t._l(t.variants,(function({value:e,label:i}){return s("checkbox-dropdown",{key:+e,attrs:{name:`user_status_visibility_${t.id}`,label:i,value:e,disabled:t.disabled},model:{value:t.statusVisibility,callback:function(e){t.statusVisibility=e},expression:"statusVisibility"}})})),1)},r=[],o=s(110908),a=function e(){var t=this,s=t._self._c;return s("b-dropdown-item",{class:{"m-disabled":t.disabled},attrs:{href:"javascript:void(0)"}},[s("radio-o-f",{attrs:{id:t.id,checked:t.modelValue===t.value,name:t.name,disabled:t.disabled,label:t.label},on:{change:function(e){return t.$emit("change",t.value)}}})],1)},n=[],d,l,h={components:{RadioOF:s(82796).A},model:{prop:"modelValue",event:"change"},props:{value:{type:[Number,String,Boolean],required:!0},label:{type:String,required:!0},name:{type:String,required:!0},disabled:{type:Boolean,default:!1},modelValue:{type:[Number,String,Boolean],default:""}},data(){return{id:this.uid}}},c=s(281656),u,m,p,b={name:"UsersStatus",components:{CheckboxDropdown:(0,c.A)(h,a,n,!1,null,null,null).exports},data(){return{id:this.uid,disabled:!1}},computed:{...(0,o.npG)(["authUser"]),statusVisibility:{get(){return this.authUser.isVisibleOnline},async set(e){const t=this.authUser.isVisibleOnline;this.disabled=!0,this.setAuthUserData({isVisibleOnline:e});const s=await this.patchUser({isVisibleOnline:e});null!=s&&s.success||(this.setAuthUserData({isVisibleOnline:t}),alert(this.$t("message.debug_alert_message"))),this.disabled=!1}},variants(){return[{value:!0,label:this.$t("message.user_status_available")},{value:!1,label:this.$t("message.user_status_invisible")}]}},methods:{...(0,o.CXg)(["patchUser","setAuthUserData"])}},f,g=(0,c.A)(b,i,r,!1,null,null,null).exports},426589:function(e,t){t.A={methods:{isActiveList(e){const{name:t,params:{list:s}}=this.$route,i=Number.isFinite(Number(e))?Number(e):e,r=Number.isFinite(Number(s))?Number(s):s;return["MyFriends","CustomList"].includes(t)&&i===r||"Bookmarks"===t&&"bookmarks"===s||"Favorites"===t&&"favorites"===s}}}},658056:function(e,t,s){s.d(t,{A:function(){return x}});var i=function e(){var t=this,s=t._self._c;return s("dropdown-wrapper",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("message.tooltip_more"),classes:"m-tooltip-higher"+(t.isAdditionalClass?" m-moved-dropdown-more":""),offset:t.tooltipOffset},expression:"{\n    content: $t('message.tooltip_more'),\n    classes: `m-tooltip-higher${isAdditionalClass ? ' m-moved-dropdown-more' : ''}`,\n    offset: tooltipOffset,\n  }"}],ref:"profileDropdown",class:{"m-default-hover-color":t.defaultHoverColor,"m-hover-vertical m-btn-vertical-dots":!t.iconMoreDefault},attrs:{"append-to-parent":t.isStreaming,"toggle-class":t.classBtn,"menu-class":t.menuClass,"modal-class":t.modalClass,variant:t.variant,boundary:t.boundary,"only-modal":t.isUserListModal,offset:"4",right:"",lazy:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[s("span",{staticClass:"b-dropdown-dots-wrapper"},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite:[iconMoreName]",arg:t.iconMoreName}]})])]},proxy:!0}])},[t._l(t.items,(function({isUserAvatar:e,isDivider:i,condition:r,classes:o="",clickHandler:a,title:n,isSubscribeBtn:d,isIconInfo:l,isUserVisibility:h,isSlotCondition:c,name:u},m){return[e?s("li",{key:`li_${m}`,staticClass:"m-user-data-item",attrs:{role:"presentation"}},[s("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"Profile",params:{userId:t.user.username}}}},[s("avatar",t._b({staticClass:"m-border-line",attrs:{size:24,"is-link":!1}},"avatar",t.userAvatarData,!1)),s("div",{staticClass:"b-username-row"},[s("div",{staticClass:"g-user-username m-md-size"},[t._v(" @"+t._s(t.user.username)+" ")])])],1)],1):d?s("b-dropdown-item",{key:`dropdown-item-item_${m}`,attrs:{href:"javascript:void(0)"}},[s("subscribe-btn",{attrs:{id:t.user.id,chat:t.chat},on:{"hide-dropdown":t.hideDropdown}})],1):h?s("user-visibility",{key:`user-visibility_${m}`}):i?s("b-dropdown-divider",{key:`divider_${m}`}):c?t._t(u):r?s("b-dropdown-item-button",{key:`dropdown-item-button_${m}`,class:o,on:{click:a}},[t._v(" "+t._s(n)+" "),l?s("span",{staticClass:"g-icon-info m-with-round-hover"},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite:icon-info",arg:"icon-info"},{name:"tooltip",rawName:"v-tooltip.enabled",value:{content:t.$t("message.info_ignore_user"),classes:"m-tooltip-higher",container:t.modalClass?".m-parent-tooltip-attach":void 0},expression:"{\n            content: $t('message.info_ignore_user'),\n            classes: 'm-tooltip-higher',\n            container: modalClass ? '.m-parent-tooltip-attach' : undefined,\n          }",modifiers:{enabled:!0}}],staticClass:"b-default-avatar",on:{click:function(e){return e.preventDefault(),t.prevent.apply(null,arguments)}}})]):t._e()]):t._e()]}))],2)},r=[],o=s(962193),a=s.n(o),n=s(944114),d=s(218111),l=s(13579),h=s(962953),c=s(885471),u=s(110908),m=s(148824),p=s(281436),b=s(399941),f=s(486433),g=s(684352),v=s(714358),_=s(59960),y=s(277678),$=s(426589),k=s(758987),U=s(976760),P=s(803373),C=s(463670),M=s(139162),w,S={name:"UsersAction",components:{SubscribeBtn:m.A,Avatar:p.default,UserVisibility:b.A,DropdownWrapper:f.A},mixins:[g.A,v.A,_.A,y.A,$.A],props:{user:{type:Object,default:()=>({})},classBtn:{type:String,default:"btn-link"},chat:{type:Object,default:()=>({})},subscriberItem:{type:Object,default:()=>({})},subscribeItem:{type:Object,default:()=>({})},isSubscriberCard:{type:Boolean,default:!1},menuClass:{type:[String,Object,Array],default:""},modalClass:{type:[String,Object],default:""},isFriendWidget:{type:Boolean,default:!1},isProfileMenu:{type:Boolean,default:!1},boundary:{type:[HTMLElement,String],default:"viewport"},variant:{type:String,default:"link"},isUserListModal:{type:Boolean,default:!1},isAdditionalClass:{type:Boolean,default:!1},isStoryViewer:{type:Boolean,default:!1},iconMoreDefault:{type:Boolean,default:!0},defaultHoverColor:{type:Boolean,default:!0},hasRemoveAction:{type:Boolean,default:!1},isStreamEnded:{type:Boolean,default:!1},isStreaming:{type:Boolean,default:!1},canRemoveFromFriends:{type:Boolean,default:!1},tooltipOffset:{type:Number,default:0}},setup(e){const t=(0,c.ref)(!1),s=(0,c.ref)(!1),i=undefined,r=undefined,o=undefined;return{isValidPropChat:(0,c.computed)((()=>!a()(e.chat))),isDisabledFriendUser:t,isValidPropSubscribeItem:(0,c.computed)((()=>!a()(e.subscribeItem))),isValidPropSubscriberItem:(0,c.computed)((()=>!a()(e.subscriberItem))),isDisabledMuteNotifications:s}},computed:{...(0,u.npG)(["isAuth","authUser"]),...(0,u.npG)(["authUser"]),...(0,u.ds8)(["minDiscountPercent","minSubscriptionPrice"]),...(0,u.JAb)(["campaigns","claimersList"]),userAvatarData(){return this.isFriendWidget?{user:this.user}:{userId:this.user.id}},isAuthUser(){return this.isAuth&&this.user.id&&this.authUser.id&&this.user.id===this.authUser.id},iconMoreName(){return"icon-"+(this.iconMoreDefault?"more":"more-v")},isSearchUsersPage(){return"Search"===this.$route.name},isListPage(){return[...U.I0,...U.SX,...U.ad].includes(this.$route.name)},items(){const{id:e,username:t,isBlocked:s,subscribedBy:i,showPostsInFeed:r,canTrialSend:o,subscribedOn:a,subscribedOnExpiredNow:n,notice:d,canAddSubscriber:l,canRestrict:h,isRestricted:c,disabledRestrict:u,disabledBlock:m,isStoryBlockedUser:p,feedUser:b}=this.user||{},{hasPurchasedFeed:f,canNotSendReason:g,isMutedNotifications:v}=this.chat,{subscribePrice:_,isPerformer:y}=this.authUser,{name:$}=this.$route,k="BlockedUsers"===$,U=["Profile","ProfileInner"].includes($),P=this.isAuth&&e&&this.authUser.id&&e===this.authUser.id,C=P&&y&&U,M=U||this.isListPage||this.isFriendWidget||this.isSearchUsersPage||this.isUserListModal||this.isStreaming||this.isValidPropChat&&this.user&&!s&&!["deleted_user","user_inactive"].includes(g)||!this.isValidPropChat&&this.isValidPropSubscriberItem||!this.isValidPropChat&&this.isValidPropSubscribeItem,w=this.canRemoveFromFriends&&M&&this.isFriendWidget&&(U||["ProfileFriends","MyFriends"].includes($)),S=(i||b)&&!s&&U&&!this.isFriendWidget,A=_&&_*(100-this.minDiscountPercent)/100>=this.minSubscriptionPrice,I=a||n,x=(o||A)&&!s&&I,B=this.claimersList.some((t=>t===e)),D=!s&&this.isSubscriberCard&&I;return[{isUserAvatar:M&&!P&&!this.isProfileMenu},{isDivider:M&&!P&&!this.isProfileMenu},{condition:M&&C,classes:"m-capitalize",clickHandler:()=>this.$router.push({name:"StatisticsReach"}),title:this.$t("message.stat_modal_title")},{condition:M&&C,clickHandler:()=>this.$root.$emit("bv::show::modal","ModalQRCode"),title:this.$t("message.qr_code")},{condition:M&&C,clickHandler:()=>this.$root.$emit("bv::show::modal","ModalCampaignLinks"),title:this.copyProfileLinkMixin_title},{condition:M&&!C,clickHandler:this.copyProfileLinkMixin_doCopy,title:this.copyProfileLinkMixin_title},{condition:M&&this.openCustomNamePopupMixin_canSetCustomName,clickHandler:()=>this.openCustomNamePopupMixin_doOpen(e),title:this.$t("message.title_rename_user")},{isSlotCondition:!0,name:"pin-actions"},{condition:M&&!k&&this.isAuth&&!P&&!s,clickHandler:this.openUsersListsModal,title:this.$t("message.add_to_lists_dropdown_btn"),classes:"g-nowrap"},{condition:w,clickHandler:this.removeFromFriends,title:this.$t("message.remove_from_friends_btn_label"),disabled:this.isDisabledFriendUser},{condition:M&&!k&&this.isAuth&&!P&&S,clickHandler:()=>this.hideUserPostsMixin_hidePost({userId:e}),title:this.hideUserPostsMixin_text(r),disabled:this.hideUserPostsMixin_isHideDisabled},{condition:M&&!k&&this.isAuth&&!P&&x,clickHandler:this.openDiscountModal,title:this.$t("message.give_user_a_discount_profile_dropdown_btn_label")},{condition:M&&!k&&this.isAuth&&!P&&y&&(I||B),clickHandler:()=>this.goToUsersCommentsRoute(t),title:this.$t("message.view_user_s_comments")},{condition:M&&D,clickHandler:this.openNoteModal,title:this.$t(`message.${d?"edit":"add"}_notes`)},{isSubscribeBtn:this.isValidPropChat&&!k&&!P&&l&&!i&&M},{condition:this.isValidPropChat&&!k&&f,clickHandler:()=>this.$router.push({name:"Purchased",query:{user:t}}),title:this.$t("message.message_type_purchases")},{isDivider:this.isValidPropChat&&!k&&!U},{condition:this.isValidPropChat&&!k&&!U,clickHandler:this.hideChat,title:this.$t("message.hide_chat"),classes:"m-danger"},{condition:this.isValidPropChat&&!k&&!U&&M,clickHandler:()=>this.muteNotifications(t),title:this.$t(`message.${v?"un":""}mute_notifications`),disabled:this.isDisabledMuteNotifications,classes:"m-danger"},{isDivider:this.isAuth&&M&&!P&&!k&&(!s&&(h||c)||y||i||a)},{condition:this.isAuth&&M&&!P&&!k&&!s&&!this.isStreaming&&(h||c),clickHandler:this.doMuteUser,title:this.$t("message."+(c?"unrestrict_user_username":"user_restrict_button_label_")),disabled:u,classes:"m-danger m-btn-with-hint",isIconInfo:!0},{isDivider:this.isAuth&&M&&!P&&k},{condition:this.isAuth&&M&&!P&&!this.isStreaming,clickHandler:this.doBlockUser,title:this.$t(`message.${s?"un":""}block_label`),disabled:m,classes:"m-danger"},{condition:this.isAuth&&M&&!P&&this.isStoryViewer,clickHandler:()=>this.toggleHideStoryFromUser(e),title:this.$t(`message.${p?"un":""}hide_story_btn_title`),classes:"m-danger"},{condition:this.isAuth&&M&&!P,clickHandler:this.openReportModal,title:this.$t("message.report"),classes:"m-danger"},{isDivider:this.isAuth&&M&&!k&&!U&&P},{isUserVisibility:this.isAuth&&M&&!k&&!U&&P},{isDivider:this.isAuth&&M&&this.hasRemoveAction},{condition:this.isAuth&&M&&this.hasRemoveAction,clickHandler:()=>this.$emit("remove"),title:this.$t("message.remove"),classes:"m-danger"}]}},methods:{...(0,u.tSh)(["setModalUser","setUserField"]),...(0,u.CXg)(["fetchUser","getUsersIfNeeded","toggleRestrictUser","toggleBlockUser","toggleHideStoryFromUser"]),...(0,u.TQE)(["toggleUserInList"]),...(0,u.F47)(["setReportData"]),...(0,u.bKs)(["fetchChat","hideChats","toggleMuteNotifications"]),goToUsersCommentsRoute(e){this.hideDropdown(),this.$router.push({name:"NotificationsByType",params:{type:C.MR},query:{related_user:e}})},async doMuteUser(){this.user.disabledRestrict||(this.sendClickUserStat(!0),this.isStreamEnded&&await this.triggerFetchUserById(this.user.id),this.$nextTick((async()=>{await this.toggleRestrictUser({id:this.user.id,isChatsPage:["Chat","Chats"].includes(this.$route.name),isStreamEnded:this.isStreamEnded}),"Chat"===this.$route.name&&!this.user.isRestricted&&this.$route.params.chatId&&this.$root.$emit("message::from::draft",this.$route.params.chatId)})))},openReportModal(){const{id:e}=this.user;this.setReportData({type:"user",id:e}),this.$nextTick((()=>{this.$root.$emit("bv::show::modal","ModalReport")}))},async doBlockUser(){this.user.disabledBlock||(this.user.isBlocked?(this.sendClickUserStat(),await this.toggleBlockUser({userId:this.user.id,callback:this.hideModal,routeHelpers:this.blockUserRouteFlags,redirectToChatsIfChat:this.redirectToChatsIfChat,isStreamEnded:this.isStreamEnded}),this.isValidPropChat&&await this.fetchChat(this.user.id)):(this.setModalUser({userId:this.user.id}),await this.triggerFetchUserById(this.user.id),this.$nextTick((()=>{if(this.$root.$emit("bv::show::modal","ModalBlockUser"),this.isStreamEnded){const e=({componentId:t})=>{"ModalBlockUser"===t&&(this.$root.$emit("block::user::finished::stream",this.user.id),this.$root.$off("bv::modal::show",e))};this.$root.$on("bv::modal::show",e)}}))))},sendClickUserStat(e){const t=`UsersAction_${this.$route.name}`,{user:s}=this;(0,P.A)({user:s,isRestrict:e,block:t})},openDiscountModal(){this.setModalUser({userId:this.user.id}),this.$nextTick((()=>{this.$root.$emit("bv::set::modal::promoType","discount"),this.$root.$emit("bv::show::modal","ModalPersonalOffer")}))},async openNoteModal(){await this.setModalUser({userId:this.user.id}),this.$nextTick((()=>{this.$root.$emit("bv::show::modal","ModalSubscriberNotes")}))},hideDropdown(){this.$refs.profileDropdown&&this.$refs.profileDropdown.hide()},async hideChat(){this.$nextTick((async()=>{try{const e=await this.hideChats(this.user.id);null!=e&&e.success&&this.$router.push({name:"Chats"})}catch(e){(0,k.r_)(e)}}))},async muteNotifications(e){this.isDisabledMuteNotifications=!0;try{const t=await this.toggleMuteNotifications(this.user.id);null!=t&&t.success&&this.$bvToast.toast(this.$t(this.$t(`message.${this.chat.isMutedNotifications?"":"un"}mute_notifications_chats_toast`,{USERNAME:e})),M.C_)}catch(t){alert(t.data)}finally{this.isDisabledMuteNotifications=!1}},async triggerFetchUserById(e){await this.getUsersIfNeeded({entities:{users:{[e]:{_views:["m"]}}}})},async openUsersListsModal(){this.isStreamEnded&&await this.fetchUser({id:this.user.id}),this.setModalUser({userId:this.user.id}),this.$nextTick((()=>{this.$root.$emit("bv::show::modal","ModalUsersLists")}))},prevent(e){e.preventDefault(),e.stopPropagation()},async removeFromFriends(){this.isDisabledFriendUser=!0;const e="friends";await this.toggleUserInList({listId:e,userId:this.user.id,isChatsPage:["Chat","Chats"].includes(this.$route.name),isProfilePage:"Profile"===this.$route.name,isActiveList:this.isActiveList(e)}),this.isDisabledFriendUser=!1}}},A,I,x=(0,s(281656).A)(S,i,r,!1,null,null,null).exports},684352:function(e,t,s){var i=s(110908);t.A={data(){return{hideUserPostsMixin_isHideDisabled:!1}},computed:{...(0,i.ZOz)(["getUser"]),...(0,i.rj2)(["feedFiltersIds"])},methods:{...(0,i.CXg)(["toggleHiddenPosts"]),...(0,i.yKE)(["filterHiddenUserFeedPosts"]),hideUserPostsMixin_text(e){return this.$t(`message.post_dropdown_${e?"hide":"show"}_posts`)},async hideUserPostsMixin_hidePost({userId:e,isFeed:t=!1}){this.hideUserPostsMixin_isHideDisabled=!0,this.$nextTick((async()=>{var s;await this.toggleHiddenPosts(e);const i=this.getUser(e);!t||!1!==(null==i?void 0:i.showPostsInFeed)||null!==(s=this.feedFiltersIds)&&void 0!==s&&s.length||(this.filterHiddenUserFeedPosts(e),alert(this.$t("message.hide_user_posts_from_feed_alert")))})),this.hideUserPostsMixin_isHideDisabled=!1}}}},714358:function(e,t,s){var i=s(110908);t.A={computed:{...(0,i.npG)(["authUser"]),openCustomNamePopupMixin_canSetCustomName(){return!this.isAuthUser&&this.authUser.isPerformer&&!this.user.isBlocked&&(this.user.subscribedOn||this.user.subscribedOnExpiredNow)}},methods:{...(0,i.tSh)(["setModalUser"]),openCustomNamePopupMixin_doOpen(e){this.setModalUser({userId:e}),this.$nextTick((()=>{this.$root.$emit("bv::show::modal","ModalCustomName")}))}}}},803373:function(e,t,s){var i=s(18188);t.A=({block:e,isRestrict:t,user:s})=>{const r=t?"RestrictUser":"BlockUser",o=undefined;(t?!s.isRestricted:!s.isBlocked)&&(0,i.tP)({page:r,eventTime:(new Date).toISOString(),block:e})}}}]);