"use strict";(self.webpackChunkof_vue=self.webpackChunkof_vue||[]).push([[61594],{176041:function(e,t,i){i.d(t,{cZ:function(){return r},iM:function(){return n},p0:function(){return d}});var o=i(974353),s=i.n(o);const r=e=>{const{mediaType:t,type:i,convertedToVideo:o}=e;return[t,i].includes("video")||o&&"gif"===i||"mp4"===n(e).split("?").shift().split(".").pop().toLowerCase()},n=e=>{var t;const i=undefined;return!(null===(t=e.files)||void 0===t||!t.drm)?e.files.drm:(null===(o=e.files)||void 0===o||null===(o=o.full)||void 0===o?void 0:o.url)||e.sourceUrl||"";var o},d=({media:e,nativeError:t,playerError:i,videoElement:o,additionalInfo:r={}})=>{var n;const{networkState:d,readyState:a,duration:l,initNetworkState_:u}=o,h=null===(n=t.target)||void 0===n||null===(n=n.firstChild)||void 0===n?void 0:n.currentSrc,p=o.canPlayType('video/mp4; codecs="avc1.42E01E"'),c=["NETWORK_EMPTY","NETWORK_IDLE","NETWORK_LOADING","NETWORK_NO_SOURCE"],m=undefined,P=undefined,E=undefined,f=undefined,w=undefined,v=undefined;return{nativeError:t,playerError:i,data:{src:h,videoNetworkState:c[d],videoInitNetworkState:`${c[u]} / ${u}`,videoReadyState:["HAVE_NOTHING","HAVE_METADATA","HAVE_CURRENT_DATA","HAVE_FUTURE_DATA","HAVE_ENOUGH_DATA"][a],duration:l,canPlay:p,time:`${s()(null==e?void 0:e.createdAt).fromNow()} / ${null==e?void 0:e.createdAt} / ${s()().toString()}`,status:"ok",...r}}}},561594:function(e,t,i){var o=i(501882),s=i.n(o),r=i(97200),n=i.n(r),d=i(858156),a=i.n(d),l=i(16280),u=i.n(l),h=i(944114),p=i.n(h),c=i(218111),m=i.n(c),P=i(22489),E=i.n(P),f=i(720116),w=i.n(f),v=i(607588),I=i.n(v),R=i(161701),A=i.n(R),g=i(18237),O=i.n(g),y=i(962953),S=i.n(y),_=i(885471),T=i(775074),M=i(110908),W=i(547822),b=i(921914),C=i(176041),k=i(463670),V=i(758987),D=i(724022),H=i(748977);const N=new _.default({render:e=>e(T.A,{props:{mainClasses:"b-photos__item m-square",unknownBlockClasses:"post-purchase",iconClasses:"m-fully-center-position g-gray-text"}})}).$mount().$el.outerHTML,{EVENTS:L,$emit:U,$on:G,$off:$}=(0,W.A)(),{isPhotoswipeOpen:B}=(0,D.A)();t.A={data(){return{photoswipeId:n()("photoswipe-id-")}},computed:{isPhotoswipeOpen:()=>B.value,...(0,M.YJz)(["getMessages"]),photoSwipeItems(){switch(this.$options.name){case"UserAvatar":return[this.getAvatarPreviewOptions()];case"MessagesItem":return this.message.media.filter((e=>"photo"===e.type)).map((e=>{const{id:t,files:{full:{url:i="",width:o=0,height:s=0}={},preview:{url:r=""}={}}={}}=e||{};return{id:t,thumbnail:r,src:i,width:o,height:s}}));case"ChatGallery":{const e=[];return this.getMessages(this.media).forEach((t=>{t.isMediaReady&&t.media.forEach((i=>{if((0,C.iM)(i)&&null!=i&&i.canView&&this.isValidType(i)){const{id:r,files:{full:{width:n=0,height:d=0}={},thumb:a}={}}=i||{};var o,s;if("photo"===i.type)e.push({id:r,height:d,width:n,src:null===(o=i.files)||void 0===o||null===(o=o.full)||void 0===o?void 0:o.url,thumbnail:null==a?void 0:a.url,thumb:null==a?void 0:a.url});if(["video","gif","audio"].includes(i.type))e.push({id:r,entityId:t.id,entityType:k.Tj.MESSAGE,media:{...i,source:{...(null===(s=i.files)||void 0===s?void 0:s.full)||{},thumb:null==a?void 0:a.url}}})}}))})),e}case"MediaVault":case"ModalMediaVault":return this.getItems.map((e=>{const{id:t,posts:i,counters:o={},createdAt:s,hasPosts:r,releaseForms:n=[],files:{full:{url:d="",width:a=0,height:l=0}={},preview:u={}}}=e;return["video","gif","audio"].includes(e.type)?{id:t,media:e,posts:i,entityType:k.Tj.OWN_MEDIA}:{id:t,media:{id:t,counters:o,createdAt:s,hasPosts:r,releaseForms:n},src:d,thumbnail:(null==u?void 0:u.url)||"",width:a,height:l,posts:i}}));case"UsersPosts":return[...this.postsPinned||[],...this.showingPosts].filter((e=>!!e.post)).reduce(((e,t)=>{if(a()(t,"post.media.length")){const{media:[i]}=t.post,o=(0,C.iM)(i),{id:s,hasPosts:r,files:{full:{width:n=0,height:d=0}={},preview:a={}}}=i;((0,C.cZ)(i)||"audio"===i.type)&&o?e.push({id:s,media:{...i,counters:{likesCount:t.post.favoritesCount||0,tipsSumm:(0,H.BT)(t.post.tipsAmount)},createdAt:t.post.postedAt},entityId:t.post.id,entityType:k.Tj.POST,postId:t.post.id,posts:[{id:t.post.id,createdAt:t.post.postedAt}]}):e.push({id:s,media:{id:s,counters:{likesCount:t.post.favoritesCount||0,tipsSumm:(0,H.BT)(t.post.tipsAmount)},createdAt:t.post.postedAt,hasPosts:r},src:o,thumbnail:(null==a?void 0:a.url)||"",width:n,height:d,postId:t.post.id,canViewMedia:t.post.canViewMedia,html:o||i.canView?"":N,posts:[{id:t.post.id,createdAt:t.post.postedAt}]})}return e}),[]);case"MakeFeedPost":return this.uploadedFilesWithoutAudio.reduce(((e,t)=>{var i,o;if(100!==t.progress||"DELETE"!==t.deleteType)return e;if(!["photo","gif","video"].includes(t.mediaType))return e;if(!(0,b.O)(t))return e;const s=t.id||t.processId;if((0,C.cZ)(t)){var r;const t=null===(r=this.videoSourcesForPhotoSwipe)||void 0===r?void 0:r[s];return[...e,{id:s,media:t,fileId:s,entityType:k.Tj.OWN_MEDIA}]}let n=t.url||"",d=t.url||"";if(null!==(i=t.url)&&void 0!==i&&i.startsWith("blob:http")&&t.sourceUrl&&(n=t.sourceUrl,d=t.sourceUrl),"video"===t.mediaType&&!t.processId&&null!==(o=t.thumbs)&&void 0!==o&&o.length){const e=t.thumbs.find((({id:e})=>e===t.thumbId));n=(null==e?void 0:e.url)||n,d=(null==e?void 0:e.url)||d}return[...e,{id:s,fileId:s,src:d,thumbnail:n,width:t.width||0,height:t.height||0,...t.orientation&&{orientation:t.orientation},...t.rotation&&{rotation:t.rotation}}]}),[]);case"PostMedia":return this.visibleMediaWithoutAudio.map((e=>{const t={...e},i=undefined;if(["full","preview","thumb"].forEach((i=>{var o;!t[i]&&null!==(o=e.files)&&void 0!==o&&null!==(o=o[i])&&void 0!==o&&o.url&&(t[i]=e.files[i].url)})),(0,C.cZ)(e))return{id:e.id,media:t,entityId:this.entityId,entityType:this.entityType};const{id:o,files:{full:{url:s,width:r=0,height:n=0}={},preview:d={},thumb:a={}}}=e,l=(null==d?void 0:d.url)||(null==a?void 0:a.url);let u=s;return"string"!=typeof u&&(u=l,(0,V.Bg)({error:new Error("post media has incorrect value"),extra:{post:this.post}})),{id:o,thumbnail:l,src:u,width:r,height:n,postId:this.post.id}}));case"PostLabelPage":case"CustomListPosts":case"PostsBookmarks":case"ProfileLastPosts":return this.showingPosts.filter((e=>!!e.post)).reduce(((e,t)=>{if(a()(t,"post.media.length")){const{media:[i]}=t.post,o=(0,C.iM)(i),{id:s,files:{full:{width:r=0,height:n=0}={},preview:d={}}}=i;((0,C.cZ)(i)||"audio"===i.type)&&o?e.push({id:s,media:i,postId:t.post.id}):e.push({id:s,media:{id:s},src:o,thumbnail:(null==d?void 0:d.url)||"",width:r,height:n,postId:t.post.id})}return e}),[]);case"MassMessagesStat":return this.mediaFiles.reduce(((e,t)=>{const i=(0,C.iM)(t),{id:o,files:{full:{width:s=0,height:r=0}={},preview:n={}}}=t;return((0,C.cZ)(t)||"audio"===t.type)&&i?e.push({id:o,media:t}):e.push({id:o,media:{id:o},src:i,thumbnail:null==n?void 0:n.url,width:s,height:r}),e}),[]);case"NotificationsMedia":case"UserAlertMedia":return this.media?this.media.reduce(((e,t)=>{if(null!=t&&t.canView&&this.isValidType(t)){const{id:i,files:{full:{url:o,width:s=0,height:r=0}={},thumb:n={}},duration:d=0}=t;"photo"===t.type?e.push({id:i,height:r,width:s,src:o,thumbnail:null==n?void 0:n.url,thumb:null==n?void 0:n.url}):["video","gif","audio"].includes(t.type)&&e.push({id:i,media:{...t,duration:d,src:o}})}return e}),[]):this.getPreview();case"LawEnforcementMediaDocs":return this.getLegalinqMedia();default:return[]}}},beforeDestroy(){$(L.PHOTOSWIPE_WRAPPER.CLOSED,this.onPhotoswipeClose),$(L.PHOTOSWIPE_WRAPPER.ERROR.MEDIA,this.onPhotoswipeMediaError),$(L.PHOTOSWIPE_WRAPPER.ERROR.IMAGE,this.onPhotoswipeImageError),$(L.PHOTOSWIPE_WRAPPER.ERROR.VIDEO,this.onPhotoSwipeVideoError)},mounted(){G(L.PHOTOSWIPE_WRAPPER.CLOSED,this.onPhotoswipeClose)},methods:{onPhotoSwipeVideoError({photoswipeId:e,data:t}={}){if(e===this.photoswipeId){try{const e=undefined;switch(this.$options.name){case"PostMedia":case"MessagesItem":this.mediaError();break;case"ChatGallery":this.fetchAndGetChatsUsersMedia({lastId:null==t?void 0:t.entityId});break;case"MediaVault":case"ModalMediaVault":this.fetchAndGetMediaVaultByType()}}catch(i){(0,V.r_)(i)}$(L.PHOTOSWIPE_WRAPPER.ERROR.VIDEO,this.onPhotoSwipeVideoError)}},async onPhotoswipeMediaError({photoswipeId:e,data:t}={}){if("MakeFeedPost"===this.$options.name&&e===this.photoswipeId&&s()(this.refreshFileUrl)&&null!=t&&t.mediaId){const e=undefined;await this.refreshFileUrl(t.mediaId)&&this.updatePhotoSwipeDataSource()}},onPhotoswipeImageError({photoswipeId:e}={}){e===this.photoswipeId&&s()(this.mediaError)&&(this.mediaError(),$(L.PHOTOSWIPE_WRAPPER.ERROR.IMAGE,this.onPhotoswipeImageError))},onPhotoswipeClose(){$(L.PHOTOSWIPE_WRAPPER.ERROR.MEDIA,this.onPhotoswipeMediaError),$(L.PHOTOSWIPE_WRAPPER.ERROR.IMAGE,this.onPhotoswipeImageError),$(L.PHOTOSWIPE_WRAPPER.ERROR.VIDEO,this.onPhotoSwipeVideoError)},showPhotoSwipe(e={}){U(L.PHOTOSWIPE_WRAPPER.OPEN,{options:e,id:this.photoswipeId,dataSource:this.photoSwipeItems}),G(L.PHOTOSWIPE_WRAPPER.ERROR.MEDIA,this.onPhotoswipeMediaError),G(L.PHOTOSWIPE_WRAPPER.ERROR.IMAGE,this.onPhotoswipeImageError),G(L.PHOTOSWIPE_WRAPPER.ERROR.VIDEO,this.onPhotoSwipeVideoError)},hidePhotoSwipe(){U(L.PHOTOSWIPE_WRAPPER.CLOSE)},updatePhotoSwipeDataSource(){this.isPhotoswipeOpen&&U(L.PHOTOSWIPE_WRAPPER.UPDATE_DATA_SOURCE,this.photoSwipeItems)},isValidType(e){const t={photos:["photo"],videos:["video","gif"],audios:["audio"]},{type:i}=this.$route.query;return!i||"all"===i||t[i].includes(e.type)}}}},775074:function(e,t,i){i.d(t,{A:function(){return l}});var o=function e(){var t=this,i=t._self._c;return i(t.routeLink?"router-link":"div",t._b({tag:"component",class:["b-post__unknown",t.mainClasses,t.withDefaultBg?"m-default-bg":"m-inactive-user"]},"component",t.attributesList,!1),[t._t("up"),t.isShowIcon?i("div",{class:["b-post__unknown__icon",{"m-fully-center-position":t.iconFullyCenter,"m-center-position":t.iconNearText,"m-grid-position":t.iconGridIcon,"m-last-post":t.iconGridIcon&&t.iconSizeMd},t.iconClasses]},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite:icon-locked",arg:"icon-locked"}],class:{"m-size-md":t.iconSizeMd}}),t.$slots.price?i("div",{staticClass:"b-post__unknown__price"},[t._t("price")],2):t._e()]):t._e(),t.message?i("p",[t._v(" "+t._s(t.message)+" ")]):t._e(),t._t("down")],2)},s=[],r,n={name:"UnknownPost",props:{message:{type:String,default:""},mainClasses:{type:String,default:""},iconClasses:{type:String,default:""},iconFullyCenter:{type:Boolean,default:!1},iconNearText:{type:Boolean,default:!1},iconGridIcon:{type:Boolean,default:!1},isShowIcon:{type:Boolean,default:!0},iconSizeMd:{type:Boolean,default:!1},withDefaultBg:{type:Boolean,default:!0},routeLink:{type:[Object,null],default:null}},computed:{attributesList(){return this.routeLink?{to:this.routeLink}:null}}},d,a,l=(0,i(281656).A)(n,o,s,!1,null,null,null).exports}}]);